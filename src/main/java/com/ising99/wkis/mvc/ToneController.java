package com.ising99.wkis.mvc;import com.ising99.wkis.common.SessionInfo;import com.ising99.wkis.common.SessionManager;import com.ising99.wkis.domain.*;import com.ising99.wkis.parameter.*;import org.apache.log4j.Logger;import com.ising99.wkis.service.ToneService;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import javax.annotation.Resource;import java.util.*;@Controller@RequestMapping("player/tone")public class ToneController extends BaseController {    private static final Logger logger = Logger.getLogger(ToneController.class);    @Resource    private ToneService toneService;    @RequestMapping("/add")    @ResponseBody    public String addRecord(Integer singerid,Integer topnote,Integer highkey,Integer ddtype,Integer sex,Integer ismusictraining,Integer autokeytip,String touxiang,String result,String hkfreqz,String hasdd,String session){        String userid = "";        try {            SessionInfo sessionInfo = SessionManager.readSession(session);            userid = sessionInfo.getUserId();        } catch (Exception e) {            return null;        }        if(singerid==null||topnote==null||highkey==null||ddtype==null||sex==null||ismusictraining==null||autokeytip==null||touxiang==null||userid==null||result==null||hkfreqz==null||hasdd==null) {            return "{'result':'参数不正确'}";        }else{            ToneParam param = new ToneParam();            param.setSingerid(singerid);            param.setTopnote(topnote);            param.setHighkey(highkey);            param.setDdtype(ddtype);            param.setSex(sex);            param.setIsmusictraining(ismusictraining);            param.setAutokeytip(autokeytip);            param.setTouxiang(touxiang);            param.setResult(result);            param.setHkfreqz(hkfreqz);            param.setHasdd(hasdd);            param.setUserid(userid);            param.setCreatetime(new Date());            int file = toneService.add(param);            if (file == 1) {                return "{'result':'ok'}";            }else{                return "{'result':'error'}";            }        }    }    @RequestMapping("/list")    @ResponseBody    public PageData<Tone> getPageList(Integer pagesize, Integer pageindex,String session) throws Exception {        String userid = "";        try {            SessionInfo sessionInfo = SessionManager.readSession(session);            userid = sessionInfo.getUserId();        } catch (Exception e) {            return null;        }        if(pageindex==null||pagesize==null||userid==null){            return null;        }        ToneParam param = new ToneParam();        param.setUserid(userid);        param.setPageindex(pageindex);        param.setPagesize(pagesize);        PageData<Tone> list=toneService.getList(param);        return list;    }    @RequestMapping("/delete")    @ResponseBody    public String deleteRecrod(Integer id, String session) throws Exception {        String userid = "";        try {            SessionInfo sessionInfo = SessionManager.readSession(session);            userid = sessionInfo.getUserId();        } catch (Exception e) {            return null;        }        if(id==null||userid==null) {            return "{'result':'参数不正确'}";        }else {            ToneParam param = new ToneParam();            param.setId(id);            int file = toneService.delete(param);            if (file == 1) {                return "{'result':'ok'}";            } else {                return "{'result':'error'}";            }        }    }}